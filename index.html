<!DOCTYPE html>
<html lang="ml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Scoreboard - Jamal Digital Marketing Agency</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&family=Bebas+Neue&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --gold: #ffcc00; --silver: #e2e8f0; --bronze: #cd7f32; --accent: #00d2ff;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Poppins', sans-serif; color: white; overflow: hidden;
            transition: background 1.5s ease-in-out;
        }

        /* 3 ‡¥µ‡µç‡¥Ø‡¥§‡µç‡¥Ø‡¥∏‡µç‡¥§ ‡¥¨‡¥æ‡¥ï‡µç‡¥ï‡µç‡¥ó‡µç‡¥∞‡µó‡¥£‡µç‡¥ü‡µç ‡¥∏‡µç‡¥±‡µç‡¥±‡µà‡¥≤‡µÅ‡¥ï‡µæ */
        .bg-style-1 { background: radial-gradient(circle at center, #0f172a, #020617); }
        .bg-style-2 { background: linear-gradient(135deg, #1e1b4b, #312e81); }
        .bg-style-3 { background: radial-gradient(circle at top right, #1a2e05, #020617); }

        /* Header */
        .header {
            display: flex; flex-direction: column; align-items: center;
            padding: 15px; background: rgba(0,0,0,0.6); border-bottom: 5px solid var(--gold);
        }

        #main-title {
            font-family: 'Bebas Neue', sans-serif; font-size: 5.5rem; margin: 0;
            background: linear-gradient(to right, #fff, #ffcc00, #fff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: textShine 3s infinite linear; line-height: 1;
        }

        @keyframes textShine { 0% { background-position: 0% center; } 100% { background-position: 200% center; } }

        .live-box {
            background: #ff0000; color: white; padding: 4px 25px; border-radius: 50px;
            font-weight: 900; font-size: 1.1rem; animation: pulseRed 1.2s infinite; margin-top: 5px;
        }

        @keyframes pulseRed { 0% { transform: scale(1); box-shadow: 0 0 0px #ff0000; } 50% { transform: scale(1.05); box-shadow: 0 0 20px #ff0000; } 100% { transform: scale(1); } }

        /* Trophy Animations */
        .trophy-container { font-size: 7rem; margin-bottom: 10px; display: block; filter: drop-shadow(0 0 20px rgba(0,0,0,0.5)); }
        
        /* 1st Rank Trophy: Bounce & Glow */
        .t-1 { color: var(--gold); animation: bounceTrophy 2s infinite; }
        /* 2nd Rank Trophy: Rotate */
        .t-2 { color: var(--silver); animation: rotateTrophy 3s infinite ease-in-out; }
        /* 3rd Rank Trophy: Shake */
        .t-3 { color: var(--bronze); animation: shakeTrophy 0.5s infinite alternate; }

        @keyframes bounceTrophy { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px) scale(1.1); } }
        @keyframes rotateTrophy { 0%, 100% { transform: rotate(-10deg); } 50% { transform: rotate(10deg); } }
        @keyframes shakeTrophy { from { transform: translateX(-5px); } to { transform: translateX(5px); } }

        /* Main Slide Display */
        #display-area { height: 50vh; display: flex; align-items: center; justify-content: center; margin-top: 20px; }
        .slide {
            width: 85%; background: rgba(255,255,255,0.08); backdrop-filter: blur(25px);
            border-radius: 50px; padding: 40px; text-align: center;
            border: 2px solid rgba(255,255,255,0.15); animation: zoomFade 0.8s ease-out;
        }

        @keyframes zoomFade { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .p-name { font-size: 5rem; font-weight: 900; margin: 10px 0; letter-spacing: -1px; text-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .e-info { font-size: 1.8rem; color: var(--accent); font-weight: 700; text-transform: uppercase; }

        /* Team Footer */
        .team-bar {
            display: flex; justify-content: space-around; width: 100%; position: absolute; bottom: 100px;
        }
        .team-box { text-align: center; background: rgba(0,0,0,0.4); padding: 10px 40px; border-radius: 20px; border: 1px solid var(--gold); }
        .team-val { font-size: 3rem; font-weight: 900; color: var(--gold); }

        /* Agency Footer (Jamal Digital Marketing) */
        .agency-footer {
            position: absolute; bottom: 0; width: 100%; height: 70px;
            display: flex; align-items: center; justify-content: center;
            background: linear-gradient(90deg, #ff00cc, #3333ff, #ff00cc);
            background-size: 400% 400%; animation: gradientBG 10s infinite;
            color: white; font-weight: 800; font-size: 1.4rem; letter-spacing: 1px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        }

        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .agency-footer span { animation: textPulse 2s infinite; }
        @keyframes textPulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } 100% { transform: scale(1); opacity: 1; } }

    </style>
</head>
<body class="bg-style-1" id="main-body">

<div class="header">
    <h1 id="main-title">BUKHARIYA ARTS FEST</h1>
    <div class="live-box">LIVE UPDATING</div>
</div>

<div id="display-area">
    </div>

<div class="team-bar">
    <div class="team-box">
        <div id="t1-name" style="font-size: 1.2rem;">TEAM 1</div>
        <div class="team-val" id="t1-val">0</div>
    </div>
    <div class="team-box">
        <div id="t2-name" style="font-size: 1.2rem;">TEAM 2</div>
        <div class="team-val" id="t2-val">0</div>
    </div>
</div>

<div class="agency-footer">
    <span>Powered by Jamal Digital Marketing Agency</span>
</div>

<script>
    const tsvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ56O5aSnw7A1i-9sD2blisxpJI3OHDoZjBhDNUehlwQMHmISN9gH5e4eBNBgnIm5FU4JvHEjgZUUb8/pub?gid=0&single=true&output=tsv';

    let allResults = [];
    let currentIndex = 0;
    let bgIndex = 1;

    async function fetchData() {
        try {
            const response = await fetch(tsvUrl);
            const data = await response.text();
            const rows = data.split('\n').slice(1);
            
            let t1_total = 0, t2_total = 0;
            let teamNames = [];
            allResults = [];

            rows.forEach(row => {
                const col = row.split('\t');
                if (col.length < 5) return;
                
                const team = col[2].trim();
                const score = parseInt(col[4]) || 0;
                
                if (!teamNames.includes(team)) teamNames.push(team);
                
                if (team === teamNames[0]) t1_total += score;
                if (team === teamNames[1]) t2_total += score;

                allResults.push({
                    event: col[0], name: col[1], team: team,
                    cat: col[3], score: col[4], rank: col[5]?.trim(), rem: col[6]
                });
            });

            document.getElementById('t1-name').innerText = teamNames[0] || "TEAM A";
            document.getElementById('t2-name').innerText = teamNames[1] || "TEAM B";
            document.getElementById('t1-val').innerText = t1_total;
            document.getElementById('t2-val').innerText = t2_total;
        } catch (e) { console.log(e); }
    }

    function rotateSlide() {
        if (allResults.length === 0) return;
        const d = allResults[currentIndex];
        const area = document.getElementById('display-area');

        let trophyClass = "";
        let trophyIcon = "üèÜ"; 

        if (d.rank === '1') trophyClass = "t-1";
        else if (d.rank === '2') trophyClass = "t-2";
        else if (d.rank === '3') trophyClass = "t-3";
        else trophyIcon = "üèÖ"; // ‡¥Æ‡¥±‡µç‡¥±‡µç ‡¥∏‡µç‡¥•‡¥æ‡¥®‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥Æ‡µÜ‡¥°‡µΩ

        area.innerHTML = `
            <div class="slide">
                <div class="trophy-container ${trophyClass}">${trophyIcon}</div>
                <div class="e-info">${d.event} | ${d.cat}</div>
                <h2 class="p-name">${d.name}</h2>
                <div style="font-size: 1.8rem; font-weight: bold; background: rgba(0,0,0,0.3); display: inline-block; padding: 5px 30px; border-radius: 50px;">
                    Team: ${d.team}
                </div>
                <div style="margin-top: 15px; font-size: 2.2rem; font-weight: 900; color: var(--gold);">
                    RANK: ${d.rank} (Points: ${d.score})
                </div>
            </div>
        `;

        if (d.rank === '1') {
            confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
        }
        currentIndex = (currentIndex + 1) % allResults.length;
    }

    function changeBackground() {
        const body = document.getElementById('main-body');
        body.className = '';
        bgIndex = bgIndex === 3 ? 1 : bgIndex + 1;
        body.classList.add('bg-style-' + bgIndex);
    }

    fetchData();
    setInterval(fetchData, 30000);
    setInterval(rotateSlide, 5000); // 5 ‡¥∏‡µÜ‡¥ï‡µç‡¥ï‡µª‡¥°‡¥ø‡µΩ ‡¥∏‡µç‡¥≤‡µà‡¥°‡µç ‡¥Æ‡¥æ‡¥±‡µÅ‡¥Ç
    setInterval(changeBackground, 5000); // 5 ‡¥∏‡µÜ‡¥ï‡µç‡¥ï‡µª‡¥°‡¥ø‡µΩ ‡¥¨‡¥æ‡¥ï‡µç‡¥ï‡µç‡¥ó‡µç‡¥∞‡µó‡¥£‡µç‡¥ü‡µç ‡¥Æ‡¥æ‡¥±‡µÅ‡¥Ç
</script>

</body>
</html>